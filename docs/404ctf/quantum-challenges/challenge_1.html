<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Le magicien quantique">
<meta name="dcterms.date" content="2024-05-12">

<title>Challenge 1 : Découverte de l’encodage par rail – quartest</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quartest</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/sckathach">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Challenge 1 : Découverte de l’encodage par rail</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">404 CTF</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../404ctf/ai-challenges/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI Challenges</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/chall_1-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/chall_2-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/chall_3-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/chall_4-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/challenge_1_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/challenge_2_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/challenge_3_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/ai-challenges/challenge_4_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 4</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../404ctf/quantum-challenges/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Challenges</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/challenge_1-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/challenge_2-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/challenge_3-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/challenge_4-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Challenge 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/chall_1_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/chall_2_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/chall_3_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../404ctf/quantum-challenges/chall_4_solution-english_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solution Challenge 4</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#encoder-des-qubits" id="toc-encoder-des-qubits" class="nav-link active" data-scroll-target="#encoder-des-qubits"><span class="header-section-number">1</span> Encoder des qubits ?</a></li>
  <li><a href="#le-début-des-problèmes" id="toc-le-début-des-problèmes" class="nav-link" data-scroll-target="#le-début-des-problèmes"><span class="header-section-number">2</span> Le début des problèmes…</a></li>
  <li><a href="#un-nouveau-challenger-le-déphaseur" id="toc-un-nouveau-challenger-le-déphaseur" class="nav-link" data-scroll-target="#un-nouveau-challenger-le-déphaseur"><span class="header-section-number">3</span> Un nouveau challenger : le déphaseur</a></li>
  <li><a href="#à-vous-de-jouer" id="toc-à-vous-de-jouer" class="nav-link" data-scroll-target="#à-vous-de-jouer"><span class="header-section-number">4</span> À vous de jouer !</a>
  <ul class="collapse">
  <li><a href="#étape-1" id="toc-étape-1" class="nav-link" data-scroll-target="#étape-1"><span class="header-section-number">4.1</span> Étape 1</a></li>
  <li><a href="#étape-2" id="toc-étape-2" class="nav-link" data-scroll-target="#étape-2"><span class="header-section-number">4.2</span> Étape 2</a></li>
  <li><a href="#un-dernier-outil-pour-la-route-la-sphère-de-bloch" id="toc-un-dernier-outil-pour-la-route-la-sphère-de-bloch" class="nav-link" data-scroll-target="#un-dernier-outil-pour-la-route-la-sphère-de-bloch"><span class="header-section-number">4.3</span> Un dernier outil pour la route : la sphère de Bloch</a></li>
  <li><a href="#étape-finale" id="toc-étape-finale" class="nav-link" data-scroll-target="#étape-finale"><span class="header-section-number">4.4</span> Étape finale</a></li>
  </ul></li>
  <li><a href="#avez-vous-remarqué" id="toc-avez-vous-remarqué" class="nav-link" data-scroll-target="#avez-vous-remarqué"><span class="header-section-number">5</span> Avez-vous remarqué ?</a></li>
  <li><a href="#récupération-du-drapeau" id="toc-récupération-du-drapeau" class="nav-link" data-scroll-target="#récupération-du-drapeau"><span class="header-section-number">6</span> Récupération du drapeau</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Challenge 1 : Découverte de l’encodage par rail</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Le magicien quantique </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="abd58bf8-045f-4d78-84e9-5328ea5dea4f" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install numpy perceval<span class="op">-</span>quandela qiskit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e156d68cbc62a3bb" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> perceval <span class="im">as</span> pcvl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="memes/challenge_1-francais.jpg" class="img-fluid figure-img"></p>
<figcaption>railway_meme.jpg</figcaption>
</figure>
</div>
<section id="encoder-des-qubits" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="encoder-des-qubits"><span class="header-section-number">1</span> Encoder des qubits ?</h2>
<p>L’information quantique portée par un <strong>qubit</strong> peut être représentée de différentes manières. Nous utilisons ici le modèle d’ordinateur quantique photonique, c’est-à-dire, qui fonctionne avec <strong>des photons</strong> et <strong>du matériel optique</strong>.</p>
<div id="6706e4db218c5796" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une magnifique porte </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x_gate <span class="op">=</span> pcvl.PERM([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(x_gate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Travailler avec des photons comporte beaucoup d’avantages, toutes les opérations sont possibles, avec des applications directes dans les télécommunications notamment, la mise à l’échelle est facilitée et la consommation est moindre.</em></p>
<div id="5150c9689952557a" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une autre magnifique porte</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hadamard_gate <span class="op">=</span> pcvl.BS.H()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(hadamard_gate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plusieurs façons d’encoder des qubits avec des photons existent, nous avons choisi de nous concentrer sur l’encodage en <strong>double rail</strong>, car elle est plus facile à appréhender.</p>
<div id="b567e1429c2584c3" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>qubits <span class="op">=</span> {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0"</span>: pcvl.BasicState([<span class="dv">1</span>, <span class="dv">0</span>]),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span>: pcvl.BasicState([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Le qbit 0 sur le premier rail :"</span>, qubits[<span class="st">"0"</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Le qbit 1 sur le second rail :"</span>, qubits[<span class="st">"1"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut alors effectuer des opérations sur ces rails pour simuler des <strong>portes logiques</strong>. Par exemple une porte <em>not</em> (<code>x_gate</code>) :</p>
<div id="3e82fbcf9632058b" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On crée une simulation de notre circuit : x_gate</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> pcvl.Processor(<span class="st">"Naive"</span>, x_gate)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On analyse la sortie produite avec un qubit 0 à l'entrée</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(p, [qubits[<span class="st">"0"</span>]], <span class="st">'*'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut aussi essayer avec <strong>plusieurs entrées</strong> :</p>
<div id="5993db76-555d-45bf-b622-6a5d4558c914" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionnaire (inverse de qubit défini au dessus) servant à afficher directement les qubits lorsqu'on</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># utilise des fonctions comme l'ananlyseur. </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>qubits_ <span class="op">=</span> {qubits[k]: k <span class="cf">for</span> k <span class="kw">in</span> qubits}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Le '*' dans la définition précédente d'analyser servait à afficher toutes les sorties possible, ici,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># j'ai précisé quelles sorties je voulais pour les avoir dans l'ordre que je souhaite. </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    p, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    mapping<span class="op">=</span>qubits_</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Toutes les opérations peuvent se représenter par des <strong>matrices unitaires</strong>. Par exemples le circuit précédent peut se résumer par :</p>
<div id="708a3b33-19ee-4f9f-9d25-e35f7ec6bb57" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(x_gate.definition())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De manière générale : <span class="math display">\[
|\phi\rangle = U|\psi\rangle
\]</span></p>
<p>Et ici : <span class="math display">\[
|\phi\rangle = X|1\rangle = \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \begin{pmatrix} 1 \\ 0 \end{pmatrix} = |0\rangle
\]</span></p>
<p>La <strong>concaténation de circuits</strong> se traduit par une simple <strong>multiplication matricielle</strong> :</p>
<div id="c32699e7-ea9f-4648-b5b6-0adaa491f04b" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>super_circuit <span class="op">=</span> x_gate <span class="op">//</span> x_gate</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_circuit.compute_unitary()) <span class="co"># On ne peut plus faire appel directement à .definition()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut essayer avec l’analyseur :</p>
<div id="a7ff9909-fe90-42d6-8321-84ec4aeeb8d4" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> pcvl.Processor(<span class="st">"Naive"</span>, super_circuit)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    p, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    mapping<span class="op">=</span>qubits_</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sans le mapping :</p>
<div id="cafe1373-54d1-4b91-9f27-ec72c4d7a0e6" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    p, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values())</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ou même observer notre magnifique super circuit qui ne <em>sert à rien</em> :</p>
<div id="0e6b8079-32ec-4c7f-8b94-b8adc18b6257" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_circuit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="le-début-des-problèmes" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="le-début-des-problèmes"><span class="header-section-number">2</span> Le début des problèmes…</h2>
<p>C’est bien gentil les portes <em>not</em>, mais on ne va pas faire grand-chose avec. Que ce passe-t-il donc si on essaye avec une <em>autre</em> porte ?</p>
<div id="6732f492-a9cd-43ff-80d3-67fc595b6653" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> pcvl.Processor(<span class="st">"Naive"</span>, hadamard_gate)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    p, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span>[qubits[<span class="st">"0"</span>]], </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    mapping<span class="op">=</span>qubits_</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Que c’est-il passé ? On a utilisé la superstar des portes quantiques : <strong>la porte d’Hadamard</strong>. C’est la <em>porte d’entrée</em> vers le monde de la quantique, elle permet de préparer un qbit dans un état <strong>superposé</strong>, ici :</p>
<p><span class="math display">\[
H = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix}
\]</span></p>
<p>Si on ajoute un <span class="math inline">\(0\)</span> en entrée : <span class="math display">\[
|\phi\rangle = H|0\rangle = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix} \begin{pmatrix} 1 \\ 0 \end{pmatrix} = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 1 \end{pmatrix}
\]</span></p>
<p>Avec : <span class="math display">\[
\frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 1 \end{pmatrix} = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0 \end{pmatrix} + \frac{1}{\sqrt{2}} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{\sqrt{2}} |0\rangle + \frac{1}{\sqrt{2}}|1\rangle
\]</span></p>
<p><em>On peut créer une porte d’Hadamard avec une lame semi-réfléchissante !</em></p>
<div id="1aae6869-a24c-4f1a-958e-80839dec7593" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(hadamard_gate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous l’avez peut-être remarqué, mais la sortie de l’analyseur n’est pas la même que celle des équations. En effet, <span class="math inline">\(|\phi\rangle\)</span> est un état quantique, qui peut être <strong>complexe</strong> : <span class="math inline">\(|\phi\rangle = \frac{i}{\sqrt{2}} |0\rangle - \frac{i}{\sqrt{2}} |1\rangle\)</span>, alors que les probabilités d’observer un état plutôt qu’un autre sont bien réelles ! Pour passer aux probabilités, il suffit de <strong>prendre le carré</strong>. Par exemple pour l’exemple précédent : <span class="math inline">\(\Pr(|0\rangle) = \left|\frac{1}{\sqrt{2}}\right|^2 = \frac{1}{2}\)</span>. Ce qui correspond bien à la sortie de notre analyseur.</p>
<p>Pour obtenir les amplitudes complexes, on peut utiliser un <em>backend</em> :</p>
<div id="0827a191-607e-48b5-aa23-747f9bbbf6ec" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>backend <span class="op">=</span> pcvl.BackendFactory.get_backend(<span class="st">"Naive"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>backend.set_circuit(hadamard_gate)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>backend.set_input_state(qubits[<span class="st">"0"</span>])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ampl0, ampl1 <span class="op">=</span> backend.prob_amplitude(qubits[<span class="st">"0"</span>]), backend.prob_amplitude(qubits[<span class="st">"1"</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"|phi&gt; = </span><span class="sc">{</span>ampl0<span class="sc">}</span><span class="ss"> |0&gt; + </span><span class="sc">{</span>ampl1<span class="sc">}</span><span class="ss"> |1&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On retrouve bien le résultat des équations : <span class="math display">\[
|\phi\rangle = \frac{1}{\sqrt{2}} |0\rangle + \frac{1}{\sqrt{2}}|1\rangle
\]</span></p>
<p><em>Cette suite de challenge ne vise pas à entrer dans les détails théoriques, mais à découvrir l’écosystème des ordinateurs quantiques en pratiquant. Si vous souhaitez en apprendre plus, je vais essayer de mettre des ressources progressives dans chaque challenge. Voici déjà une belle introduction faite par Science Étonnante : https://youtu.be/bayTbt_8aNc</em>.</p>
</section>
<section id="un-nouveau-challenger-le-déphaseur" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="un-nouveau-challenger-le-déphaseur"><span class="header-section-number">3</span> Un nouveau challenger : le déphaseur</h2>
<p>En plus d’avoir des amplitudes complexes, on peut les manipuler grâce à un outil très puissant : le <strong>déphaseur</strong>. Il s’applique à <strong>un rail</strong> et effectue l’opération : <span class="math inline">\(e^{i\theta}\)</span>.</p>
<div id="79a8a80b-9161-4c2c-a9e9-62d724bbed9d" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>phase_shifter <span class="op">=</span> pcvl.PS(np.pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(phase_shifter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dans un circuit cela donne :</p>
<div id="8640dbaa-9127-4605-96cf-13370095406c" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>circuit_ps <span class="op">=</span> pcvl.Circuit(<span class="dv">2</span>) <span class="op">//</span> (<span class="dv">0</span>, phase_shifter)  <span class="co"># Le 0 correspond au numéro du rail où est positionné </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                                    <span class="co"># notre composant </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(circuit_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avec sa <strong>matrice unitaire</strong> associée :</p>
<div id="24619349-f5f0-4dd0-ac3f-fcae98621df3" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(circuit_ps.compute_unitary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il est aussi possible de regarder directement ce que donnent les <strong>amplitudes</strong> :</p>
<div id="51793b16-9d59-4539-b888-aa30f998fe7f" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>backend_ps <span class="op">=</span> pcvl.BackendFactory.get_backend(<span class="st">"Naive"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>backend_ps.set_circuit(circuit_ps)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>backend_ps.set_input_state(qubits[<span class="st">"0"</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ampl0, ampl1 <span class="op">=</span> backend_ps.prob_amplitude(qubits[<span class="st">"0"</span>]), backend_ps.prob_amplitude(qubits[<span class="st">"1"</span>])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"|phi&gt; = </span><span class="sc">{</span>ampl0<span class="sc">}</span><span class="ss"> |0&gt; + </span><span class="sc">{</span>ampl1<span class="sc">}</span><span class="ss"> |1&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut s’amuser à reproduire des portes connues, comme la porte <em>not</em> :</p>
<div id="5f0633c1-b887-4a75-b7fd-dd9a7dc086ae" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>super_not <span class="op">=</span> hadamard_gate <span class="op">//</span> (<span class="dv">1</span>, pcvl.PS(np.pi)) <span class="op">//</span> hadamard_gate</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_not)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8f894007-6293-43d4-ad49-dc9d30f43626" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> pcvl.Processor(<span class="st">"Naive"</span>, super_not)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>analyser <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    p, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values()), </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    mapping<span class="op">=</span>qubits_</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(analyser)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Que s’est-il passé ? Dans la base canonique <span class="math inline">\(\left(|0\rangle = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, |1\rangle = \begin{pmatrix} 0 \\ 1 \end{pmatrix}\right)\)</span>, appliquer un changement de phase sur l’un des deux rails n’aurait rien changé. Par contre, en passant dans une autre base :</em> <span class="math display">\[
H|0\rangle = H \begin{pmatrix} 1 \\ 0 \end{pmatrix} = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 1 \end{pmatrix} = |+\rangle
\]</span></p>
<p><span class="math display">\[
H|1\rangle = H \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ -1 \end{pmatrix} = |-\rangle
\]</span></p>
<p><em>On remarque que “0” et “1” diffèrent uniquement d’un changement de phase, ici un décalage de <span class="math inline">\(e^{i\pi}\)</span> sur le deuxième rail. Il suffit donc de passer dans la nouvelle base, déphaser le deuxième rail, et revenir dans la base canonique (<span class="math inline">\(H\)</span> est sa propre inverse, donc facile).</em></p>
</section>
<section id="à-vous-de-jouer" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="à-vous-de-jouer"><span class="header-section-number">4</span> À vous de jouer !</h2>
<p>Pour cette partie, nous allons utiliser la généralisation de la porte d’Hadamard : un <em>Beam Splitter</em>. Voici ses paramètres :</p>
<div id="690a40b0-d839-435f-b8dd-676f965ee59c" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut définir des variables symboliques : </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>symbolic_alpha <span class="op">=</span> pcvl.P(<span class="st">'α'</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>simple_bs <span class="op">=</span> pcvl.BS(theta<span class="op">=</span>symbolic_alpha)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(simple_bs.U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="de2cf8e8-0f08-4e65-ac65-79c1e4e91c17" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Puis leur assigner une valeur : </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>simple_bs.assign({<span class="st">'α'</span>: np.pi<span class="op">/</span><span class="dv">2</span>})</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(simple_bs.compute_unitary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="12578527-e893-4ec3-bf47-04f6991dd0fb" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou changer ensuite de valeur : </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>symbolic_alpha.set_value(np.pi)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(simple_bs.compute_unitary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="étape-1" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="étape-1"><span class="header-section-number">4.1</span> Étape 1</h3>
<p>Considérant le circuit suivant (qui correspond à la définition du <em>Beam Splitter</em> d’au-dessus) :</p>
<div id="56b004f0-b492-4432-a079-87603f193705" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>step_one <span class="op">=</span> simple_bs</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(step_one)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et une valeur d’entrée : <span class="math inline">\(|0\rangle\)</span>,</p>
<p>Quelle valeur de <span class="math inline">\(\alpha\)</span> prendre pour avoir une probabilité de 0.9 d’avoir <span class="math inline">\(|1\rangle\)</span> ?</p>
<div id="85360ec3-9512-4f30-8651-515588e721e2" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> ...</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">raise</span> <span class="pp">NotImplementedError</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b6b45507-b041-43bd-8b09-fe96ee791766" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>step_one.assign({<span class="st">'α'</span>: alpha})</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(step_one)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2936ce07-6bc5-484d-a6f8-43ce5edc1ebf" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p_step_one <span class="op">=</span> pcvl.Processor(<span class="st">"Naive"</span>, step_one)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>a_step_one <span class="op">=</span> pcvl.algorithm.Analyzer(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    p_step_one, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    input_states<span class="op">=</span>[qubits[<span class="st">"0"</span>]], </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    output_states<span class="op">=</span><span class="bu">list</span>(qubits.values()),             </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    mapping<span class="op">=</span>qubits_</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"L'analyser doit renvoyer : 1/10 pour 0 et 9/10 pour 1"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(a_step_one)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># assert np.isclose(a_step_one.distribution[0][1].real, 0.9) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="étape-2" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="étape-2"><span class="header-section-number">4.2</span> Étape 2</h3>
<p>En considérant le circuit suivant, ainsi qu’une valeur d’entrée de <span class="math inline">\(|0\rangle\)</span>, trouvez les valeurs de <span class="math inline">\(\beta\)</span> et <span class="math inline">\(\gamma\)</span> pour préparer un qbit dans l’état : <span class="math display">\[
|\psi\rangle = \frac{\sqrt{3}}{2} |0\rangle + \left(\frac{\sqrt{3}}{4} - \frac{i}{4} \right)|1\rangle
\]</span></p>
<div id="733cd719-d51a-4404-8ae3-c816d49460de" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>symbolic_beta <span class="op">=</span> pcvl.P(<span class="st">"β"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>symbolic_gamma <span class="op">=</span> pcvl.P(<span class="st">"γ"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>step_two <span class="op">=</span> pcvl.BS(theta<span class="op">=</span>symbolic_beta) <span class="op">//</span> (<span class="dv">1</span>, pcvl.PS(phi<span class="op">=</span>symbolic_gamma))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(step_two)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="643ab2bf-6f47-45bc-a997-99ec02bc6433" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> ...</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> ...</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="cf">raise</span> <span class="pp">NotImplementedError</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="446b475e-8d22-4d9a-b6b9-560d07eabafb" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>step_two.assign({<span class="st">"β"</span>: beta, <span class="st">"γ"</span>: gamma})</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>b_step_two <span class="op">=</span> pcvl.BackendFactory.get_backend(<span class="st">"Naive"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>b_step_two.set_circuit(step_two)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>b_step_two.set_input_state(qubits[<span class="st">"0"</span>])</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>ampl0, ampl1 <span class="op">=</span> b_step_two.prob_amplitude(qubits[<span class="st">"0"</span>]), b_step_two.prob_amplitude(qubits[<span class="st">"1"</span>])</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> <span class="ss">f"|φ&gt; = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(ampl0, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |0&gt; + </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(ampl1, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |1&gt;"</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> <span class="ss">f"|φ&gt; = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(np.sqrt(<span class="dv">3</span>) <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="ot">0j</span>, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |0&gt; + </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(np.sqrt(<span class="dv">3</span>) <span class="op">/</span> <span class="dv">4</span> <span class="op">-</span> <span class="ot">1j</span> <span class="op">/</span> <span class="dv">4</span>, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |1&gt;"</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Résultat : </span><span class="sc">{</span>res<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Solution : </span><span class="sc">{</span>sol<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># On s'assure que la réponse est bien égale à la solution : </span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># assert res == sol</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="un-dernier-outil-pour-la-route-la-sphère-de-bloch" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="un-dernier-outil-pour-la-route-la-sphère-de-bloch"><span class="header-section-number">4.3</span> Un dernier outil pour la route : la sphère de Bloch</h3>
<p>Il se trouve que les deux résultats précédents peuvent être généralisés. Avec le circuit suivant, il est possible de préparer <strong>n’importe quel état.</strong> <em>(https://perceval.quandela.net/docs/components.html#beam-splitter)</em></p>
<div id="9c172d5d-5743-42b3-b07f-61d2976edefa" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>super_preparator <span class="op">=</span> pcvl.BS()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_preparator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La définition est en fait bien plus générale que ce qu’on a utilisé précédemment :</p>
<div id="15eabe55-3dbe-429b-8fe8-8946ca80d619" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_preparator.definition())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Par exemple, avec des valeurs aléatoires :</p>
<div id="268f11d7-2c1e-40ca-9b0e-b8cc8ca696c7" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>phi_tl, phi_tr, phi_bl, phi_br, theta_ <span class="op">=</span> [<span class="bu">round</span>(random.uniform(<span class="dv">0</span>, np.pi), <span class="dv">2</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>super_preparator <span class="op">=</span> pcvl.BS(phi_tl<span class="op">=</span>phi_tl, phi_tr<span class="op">=</span>phi_tr, phi_bl<span class="op">=</span>phi_bl, phi_br<span class="op">=</span>phi_br, theta<span class="op">=</span>theta_)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(super_preparator.U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ce qui nous permet de préparer :</p>
<div id="e2168751-9c38-4771-900e-592ec4a7c790" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>backend <span class="op">=</span> pcvl.BackendFactory.get_backend(<span class="st">"Naive"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>backend.set_circuit(super_preparator)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>backend.set_input_state(qubits[<span class="st">"0"</span>])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>ampl0, ampl1 <span class="op">=</span> backend.prob_amplitude(qubits[<span class="st">"0"</span>]), backend.prob_amplitude(qubits[<span class="st">"1"</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"|φ&gt; = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(ampl0, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |0&gt; + </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(ampl1, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> |1&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour représenter un qubit, il est possible d’utiliser la <strong>sphère de Bloch</strong>.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Bloch_sphere.svg/800px-Bloch_sphere.svg.png" alt="bloch_sphere_wikipedia.png" width="200" height="200"></p>
<p>L’axe <span class="math inline">\(Z\)</span> correspond aux états <span class="math inline">\(|0\rangle\)</span> et <span class="math inline">\(|1\rangle\)</span>, l’axe <span class="math inline">\(X\)</span> correspond aux états <span class="math inline">\(|+\rangle\)</span> et <span class="math inline">\(|-\rangle\)</span> rencontrés précédemment, et l’axe <span class="math inline">\(Y\)</span> correspond aux états <span class="math inline">\(|i\rangle\)</span> et <span class="math inline">\(|-i\rangle\)</span>.</p>
<p>On peut facilement visualiser un état avec la librairie Qiskit :</p>
<div id="03719bea-6d9d-4fd9-ba26-4c5a11b08721" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qiskit.visualization <span class="im">import</span> plot_bloch_multivector</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> qiskit.quantum_info <span class="im">import</span> Statevector</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>state_vector <span class="op">=</span> Statevector([ampl0, ampl1])  <span class="co"># À ne pas confondre avec StateVector de Perceval</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plot_bloch_multivector(state_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un simple <span class="math inline">\(|0\rangle\)</span> :</p>
<div id="4c6c37d9-02cc-4a1d-8124-d1be002dd883" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plot_bloch_multivector(np.array(qubits[<span class="st">"0"</span>]))  <span class="co"># Même chose que plot_bloch_multivector([1, 0])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Petit utilitaire pour la suite :</p>
<div id="8cabfdf2-3e38-4703-a8de-4fb4e734770f" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> circuit_to_state_vector(circuit):</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    backend <span class="op">=</span> pcvl.BackendFactory.get_backend(<span class="st">"Naive"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    backend.set_circuit(circuit)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    backend.set_input_state(qubits[<span class="st">"0"</span>])</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    ampl0, ampl1 <span class="op">=</span> backend.prob_amplitude(qubits[<span class="st">"0"</span>]), backend.prob_amplitude(qubits[<span class="st">"1"</span>])</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Statevector([ampl0, ampl1])</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plot_bloch <span class="op">=</span> <span class="kw">lambda</span> circuit: plot_bloch_multivector(circuit_to_state_vector(circuit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notre état <span class="math inline">\(|+\rangle\)</span>, fabriqué en appliquant une porte d’Hadamard sur <span class="math inline">\(|0\rangle\)</span> <span class="math inline">\(\left(|+\rangle = H|0\rangle\right)\)</span> :</p>
<div id="fc9fb535-254f-4ae5-bcd6-5e480fcc0cf9" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>plot_bloch(hadamard_gate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Étant donné que la mesure est une projection, dans notre cas, sur la base <span class="math inline">\(\left\{|0\rangle, |1\rangle\right\}\)</span>, il est plus facile de voir avec cette représentation que l’état <span class="math inline">\(|+\rangle\)</span>, quand il est mesuré, a autant de chance de donner <span class="math inline">\(0\)</span> que de donner <span class="math inline">\(1\)</span>. Il est aussi simple de voir que la phase globale (une rotation sur l’axe <span class="math inline">\(Z\)</span>), n’aura pas d’influence sur la mesure. Cela se retrouve par le calcul, pour <span class="math inline">\(|\psi\rangle = e^{i\theta} \alpha |0\rangle + e^{i\theta} \beta |1\rangle\)</span> : <span class="math display">\[
\Pr(0) = \left|e^{i\theta}\alpha\right|^2 = |\alpha|^2
\]</span> <span class="math display">\[
\Pr(1) = \left|e^{i\theta}\beta\right|^2 = |\beta|^2
\]</span></p>
<p>Par ailleurs, on peut aussi comprendre pourquoi la porte <em>not</em> s’appelle une porte <span class="math inline">\(X\)</span> : Une rotation de <span class="math inline">\(\pi\)</span> autour de l’axe <span class="math inline">\(X\)</span>, fait passer l’état <span class="math inline">\(|0\rangle\)</span> à l’état <span class="math inline">\(|1\rangle\)</span>, et inversement.</p>
</section>
<section id="étape-finale" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="étape-finale"><span class="header-section-number">4.4</span> Étape finale</h3>
<p>De nouveau, quelques fonctions utilitaires. Comme leurs noms l’indiquent, ces fonctions permettent d’effectuer des rotations selon les différents axes avec un angle choisi. Pour les combiner, il suffit d’utiliser l’opérateur //.</p>
<p><em>(PS : Rappelez vous de la règle de la main :)</em></p>
<div id="2c33df13-bf92-4ed0-badb-cd76fdca18f9" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x_rot <span class="op">=</span> <span class="kw">lambda</span> x: pcvl.Circuit(<span class="dv">2</span>) <span class="op">//</span> (<span class="dv">0</span>, pcvl.PS(np.pi)) <span class="op">//</span> pcvl.BS.Rx(theta<span class="op">=</span>x) <span class="op">//</span> (<span class="dv">0</span>, pcvl.PS(np.pi)) </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>y_rot <span class="op">=</span> <span class="kw">lambda</span> x: pcvl.BS.Ry(theta<span class="op">=</span>x)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>z_rot <span class="op">=</span> <span class="kw">lambda</span> x: pcvl.BS.H() <span class="op">//</span> x_rot(x) <span class="op">//</span> pcvl.BS.H() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se déplacer sur la sphère devient alors trivial !</p>
<div id="5392496d-09d8-4a9c-a161-7dde22930b32" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Tous les chemins partent de |0&gt; avec les fontions que j'ai écrites)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>the_way <span class="op">=</span> x_rot(<span class="op">-</span>np.pi<span class="op">/</span><span class="dv">4</span>) <span class="op">//</span> z_rot(<span class="op">-</span>np.pi<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plot_bloch(the_way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f33c2ff3-0265-44b3-8dfc-f816bc887b1d" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pcvl.pdisplay(the_way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Effectuez le chemin suivant :</p>
<p>Point de départ : <span class="math display">\[
|\phi_{start}\rangle = \frac{\sqrt{2+\sqrt{2}}}{2} |0\rangle + \frac{\sqrt{2-\sqrt{2}}}{2} e^{-i\frac{\pi}{4}} |1\rangle
\]</span></p>
<p>Étape : <span class="math display">\[
|\phi_{step}\rangle = |-\rangle
\]</span></p>
<p>Point d’arrivée : <span class="math display">\[
|\phi_{finish}\rangle = \frac{\sqrt{2-\sqrt{2}}}{2} |0\rangle + \frac{\sqrt{2+\sqrt{2}}}{2} e^{i\frac{\pi}{4}} |1\rangle
\]</span></p>
<p>Coordonnées du point de départ :</p>
<div id="3c6a942d-aa46-4333-bb39-3cd70e7f7818" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>start_state <span class="op">=</span> np.array([np.sqrt(<span class="dv">2</span><span class="op">+</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span>, np.sqrt(<span class="dv">2</span><span class="op">-</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span> <span class="op">*</span> (np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plot_bloch_multivector(start_state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coordonnées de l’étape :</p>
<div id="59a22c75-595d-4afa-bd1e-a12a43e85884" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>step_state <span class="op">=</span> np.array([np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, <span class="op">-</span>np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>])</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plot_bloch_multivector(step_state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coordonnées de l’arrivée :</p>
<div id="bcbf060d-9d12-48a9-b074-b4f0b3a6ed4f" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>finish_state <span class="op">=</span> np.array([np.sqrt(<span class="dv">2</span><span class="op">-</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span>, np.sqrt(<span class="dv">2</span><span class="op">+</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span> <span class="op">*</span> (np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)])</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>plot_bloch_multivector(finish_state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="20bcda1a-008f-400c-aca7-844251aa8a97" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> y_rot(np.pi<span class="op">/</span><span class="dv">4</span>) <span class="op">//</span> z_rot(<span class="op">-</span>np.pi<span class="op">/</span><span class="dv">4</span>)  <span class="co"># Pour se placer sur le départ</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> ...</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> ...</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>zeta <span class="op">=</span> ...</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> ... </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="cf">raise</span> <span class="pp">NotImplementedError</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Une autre façon d'enchaîner les portes </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>final_step <span class="op">=</span> (start</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                .add(<span class="dv">0</span>, z_rot(delta))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                .add(<span class="dv">0</span>, y_rot(epsilon))  <span class="co"># Arrivé à l'étape Hadamard</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                .add(<span class="dv">0</span>, y_rot(zeta))</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                .add(<span class="dv">0</span>, z_rot(eta))  <span class="co"># Fin du parcours !</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>plot_bloch(final_step)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="avez-vous-remarqué" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="avez-vous-remarqué"><span class="header-section-number">5</span> Avez-vous remarqué ?</h2>
<p><strong><em>Ceci est un point physique non important pour la validation du challenge, je le mentionne juste pour ceux qui se posent la question</em></strong>.</p>
<p>Les amplitudes de <code>start</code> et de <code>start_state</code> ne sont pas les mêmes !</p>
<p>En effet, il s’agit là d’un point que je n’ai pas abordé : les <strong>phases globales</strong> et les <strong>phases relatives</strong>. Une phase globale est une phase du type <span class="math inline">\(e^{i\theta}|\phi\rangle\)</span>, elle ne change rien dans nos calculs, car elle ne permet pas de différencier <span class="math inline">\(|0\rangle\)</span> de <span class="math inline">\(|1\rangle\)</span>. Elle <strong>n’est pas visible sur la sphère de Bloch, mais l’est en calculant les amplitudes</strong></p>
<p>Par contre, la phase relative, une phase de type <span class="math inline">\(|\psi\rangle = \alpha|0\rangle +\beta e^{i\theta}|1\rangle\)</span>, pourra avoir un impact en fonction des calculs suivants (<em>voir par exemple la technique du <strong>retour de phase</strong>, central dans l’algorithme de Shor)</em>. Elle <strong>est visible sur la sphère de Bloch et en calculant les amplitudes</strong>.</p>
<p>Du coup, quand j’ai défini :</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>start_state <span class="op">=</span> np.array([np.sqrt(<span class="dv">2</span><span class="op">+</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span>, np.sqrt(<span class="dv">2</span><span class="op">-</span>np.sqrt(<span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span> <span class="op">*</span> (np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> np.sqrt(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Les amplitudes sont : <span class="math inline">\(0.92|0\rangle + (0.27 - 0.27i)|1\rangle\)</span>. Soit : <span class="math display">\[
|\phi_{start}\rangle = \frac{\sqrt{2+\sqrt{2}}}{2} |0\rangle + \frac{\sqrt{2-\sqrt{2}}}{2} e^{-i\frac{\pi}{4}} |1\rangle
\]</span></p>
<p>Alors que quand j’ai défini :</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> y_rot(np.pi<span class="op">/</span><span class="dv">4</span>) <span class="op">//</span> z_rot(<span class="op">-</span>np.pi<span class="op">/</span><span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Les amplitudes sont : <span class="math inline">\((-0.35+0.15i)|0\rangle+ (-0.85-0.35i)|1\rangle\)</span>. Soit : <span class="math display">\[
|\phi_{start}'\rangle = \frac{\sqrt{2+\sqrt{2}}}{2} e^{i\frac{\pi}{8}} |0\rangle + \frac{\sqrt{2-\sqrt{2}}}{2} e^{-i\frac{\pi}{8}} |1\rangle
\]</span></p>
<p>On remarque que <span class="math inline">\(|\phi_{start}\rangle\)</span> et <span class="math inline">\(|\phi_{start}'\rangle\)</span> ne diffèrent que d’une phase globale :</p>
<p><span class="math display">\[
|\phi_{start}'\rangle = e^{i\frac{\pi}{8}} |\phi_{start}\rangle
\]</span></p>
<p>Dans mon exemple de <code>super_not</code> plus haut, j’ai utilisé une phase relative, tandis que lorsque j’ai expliqué les rotations <span class="math inline">\(X\)</span> et <span class="math inline">\(Z\)</span> juste avant l’étape finale, je parlais de phase globale !</p>
</section>
<section id="récupération-du-drapeau" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="récupération-du-drapeau"><span class="header-section-number">6</span> Récupération du drapeau</h2>
<p>Lancez la cellule ci-dessous en indiquant l’<em>URL</em> donné dans l’énoncé. Les tests effectués sont les mêmes que dans ce <em>notebook</em>, mais il peut y avoir des problèmes si vous avez lancé les cellules plusieurs fois. <strong>N’hésitez pas à relancer tout le <em>notebook</em> d’un coup.</strong></p>
<div id="7a4737eb-c1bb-4741-a405-e71a07a7068b" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests <span class="im">as</span> rq</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> circuit_to_list(circuit):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[(x.real, x.imag) <span class="cf">for</span> x <span class="kw">in</span> l] <span class="cf">for</span> l <span class="kw">in</span> np.array(circuit.compute_unitary())]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"step_one"</span>: circuit_to_list(step_one),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"step_two"</span>: circuit_to_list(step_two),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"final_step"</span>: circuit_to_list(final_step)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>URL <span class="op">=</span> ...</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># URL = "https://perceval.challenges.404ctf.fr"</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>rq.get(URL <span class="op">+</span> <span class="st">"/healthcheck"</span>).json()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9a00a10057d77566" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>rq.post(URL <span class="op">+</span> <span class="st">"/challenges/1"</span>, json<span class="op">=</span>d).json()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>